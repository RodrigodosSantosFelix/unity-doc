! サブステートマシン / Sub-State Machines

キャラクターが複数のステージからなる複雑なアクションをもつことは一般的です。全体のアクションをひとつのステートでハンドリングするかわりに、別々のステージを識別して各々別のステートを使用すべきです。例えば、キャラクターに、しゃがんで狙いを定め、撃って、再び立ち上がらせる、 "Trickshot" というアクションを持たせることが出来ます。

Attach:MecanimStateExcerpt.png\\
''"Trickshot" アクションにおけるステートの順序''

これはいくつかの状況で便利ですが、短所としては、ステートマシンが大きくなり、複雑なアクションがさらに追加されると扱いが難しくなります。エディタの空いたスペースで、ステートのグループを視覚的に分けることでシンプルにすることが出来ます。しかし、メカニムはさらに一歩進んで、ステートマシン図でステートのグループをひとつのアイテムに折りたたむことが出来るようにしています。これらの折りたたまれたグループは $$Sub-state machines$$ と呼びます。

サブステートマシンを作成するには ~~Animator Controller~~ ウィンドウの空いたところで右クリックして、コンテキストメニューから ^^Create Sub-State Machine^^ を選びます。サブステートマシンはエディタ上で引き伸ばされた六角形のマークによって、他の通常のステートとは区別して表示されます。

Attach:MecanimSubStateMachine.png\\
''サブステートマシン''

六角形のマークをダブルクリックすると、エディタがクリアされてサブステートマシンが元から別のステートマシンであるかのような形で編集できるようになります。ウィンドウの上にあるバーは "BreadCrumb Trail" (パンくずの軌跡) で、どのサブステートマシンが現在編集されているか示します（そして、サブステートマシンの中に別のサブステートマシンを作成するなどネストができることに注意して下さい）。Trail上でアイテムをクリックすることでエディタが特定のサブステートマシンにフォーカスします。

Attach:MecanimStateMachineCrumbs.png\\
''"Breadcrumb Trail"''

!!外部の遷移
上で記したとおり、サブステートマシンは単にエディタでステートのグループを折りたたむ方法なので、サブステートマシンへ遷移するときは、その中のどのステートに接続したいかを選択する必要があります。

Attach:MecanimSelectSubState.png\\
''"Trickshot" サブステートマシンの中からターゲットとするステートを選択''

サブステートマシンに"Up"で名前が始まる追加のステートが出来たことに気づきます。

Attach:MecanimSubStateUp.png\\
''"Up" ステート''

''Up'' ステートは "外部世界" を表し、ビューの中でサブステートマシンを包含するステートマシンです。ステートからの遷移をサブステートマシンから''Up'' のステートに追加すると、包含しているマシンの中から接続させたいステートを選ぶプロンプトが表示されます。

Attach:MecanimSubStateExternal.png\\
''包含するマシンの中のステートに接続する''

([[Animation State Machines|State Machines introduction]] に戻る)

([[MecanimAnimationSystem|Mecanim introduction]] に戻る)
