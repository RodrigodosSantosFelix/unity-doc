! アセット依存関係の管理 / Managing asset dependencies

バンドルの任意のアセットは他のアセットに依存するかもしれません。例えば、モデルはマテリアルを利用するかもしれず、テクスチャやシェーダを使用するかもしれません。アセットの依存関係をバンドルとともに全て含めることは可能です。しかし、異なるバンドルからのいくつかのアセットは他のアセットの共通セットに依存するかもしれません（例えば、ビルの複数のモデルがあった場合に共通の煉瓦のテクスチャを使用するかもしれません）。もし共通の依存関係の別の複製がオブジェクトに使用されるそれぞれのバンドルに含まれると、バンドルがロードされたときにアセットの余剰なインスタンスが作成されます。これはメモリの浪費につながります。

そのような浪費をさけるため、共有の依存関係を別のバンドルに分けることが出来て、必要とするアセットとともに、どんなバンドルからでも参照することが出来ます。最初に、[[ScriptRef:BuildPipeline.PushAssetDependencies.html|BuildPipeline.PushAssetDependencies]] をコールして参照機能を有効化する必要があります。次に参照の依存関係を含むバンドルはビルドされる必要があります。次に、PushAssetDependenciesへの別のコールを、最初のバンドルからアセットを参照するバンドルをビルドを行う前に、行う必要があります。追加の依存関係のレベルはPushAssetDependenciesに対する更なるコールにより実現することが出来ます。参照のレベルはスタックに格納されるため、ひとつレベルを戻るのに対応する [[ScriptRef:BuildPipeline.PopAssetDependencies.html|BuildPipeline.PopAssetDependencies]] 関数を使用することが出来ます。push および pop コールは、ビルド前に起きる最初のプッシュを含め、バランスをとる必要があります。

ランタイムでは、他のバンドルが参照する前に、依存関係を含むバンドルをロードする必要があります。例えば、共有テクスチャのバンドルを、そのテクスチャを参照するマテリアルの別のバンドルをロードする前にロードする必要があります。

もし依存関係のつながりの一部分であるアセットバンドルの再ビルドが必要であると考えた場合、 [[ScriptRef:BuildAssetBundleOptions.DeterministicAssetBundle.html|BuildAssetBundleOptions.DeterministicAssetBundle]] のオプションを有効化してビルドする必要があることに留意して下さい。これによりアセットを識別する内部IDの値は、バンドルが再ビルドされるたびに同じであることを保証します。


[[AssetBundlesIntro|アセットバンドル入門]] に戻る
